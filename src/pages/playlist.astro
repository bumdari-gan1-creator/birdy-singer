---
import BaseLayout from "../layouts/BaseLayout.astro";
const pageTitle = "My Playlist";
---

<BaseLayout title={pageTitle}>
  <main class="page">
    <section class="section-card playlist-card">
      <h1 class="playlist-title">{pageTitle}</h1>

      <div class="playlist-layout">
        <div class="playlist-column">
          <button id="shuffleBtn" class="shuffle-btn">Shuffle</button>

          <ul id="playlist"></ul>
        </div>

        <div class="form-column">
          <h2 class="form-title">Add a new song</h2>
          <p class="helper-text">
            Write a song title and the year it was released, then click
            <strong>Add</strong>.
          </p>

          <form id="addSongForm">
            <div class="form-row">
              <label for="songInput">Song title</label>
              <input
                id="songInput"
                type="text"
                placeholder="Insert new song name"
                required
              />
            </div>

            <div class="form-row">
              <label for="yearInput">Year</label>
              <input
                id="yearInput"
                type="number"
                placeholder="Year"
                min="1900"
                max="2099"
                required
              />
            </div>

            <button type="submit" class="add-btn">Add</button>
          </form>
        </div>
      </div>
    </section>
  </main>

  <script is:inline>
    let songs = [
      "Skinny Love (2011)",
      "Wings (2013)",
      "People Help the People (2011)",
      "Not About Angels (2014)",
      "Let It All Go (2015)",
      "Keeping Your Head Up (2015)",
      "Wild Horses (2016)",
      "Words as Weapons (2014)",
      "Light Me Up (2014)",
      "No Angel (2013)",
      "Young Blood (2011)",
      "Tee Shirt (2014)",
      "Deep End (2016)",
      "Silhouette (2016)",
      "Hear You Calling (2016)",
      "Surrender (2021)",
      "The Otherside (2021)",
      "Little Blue (2021)",
      "Raincatchers (2023)",
      "Heartbreaker (2023)"
    ];

    document.addEventListener("DOMContentLoaded", () => {
      const playlistElement = document.getElementById("playlist");
      const shuffleBtn = document.getElementById("shuffleBtn");
      const addSongForm = document.getElementById("addSongForm");
      const songInput = document.getElementById("songInput");
      const yearInput = document.getElementById("yearInput");

      function renderPlaylist() {
        playlistElement.innerHTML = "";
        songs.forEach((songTitle) => {
          const li = document.createElement("li");
          li.textContent = songTitle;
          playlistElement.appendChild(li);
        });
      }

      function shuffleSongs() {
        songs.sort(() => Math.random() - 0.5);
        renderPlaylist();
      }

      shuffleBtn.addEventListener("click", () => {
        shuffleSongs();
      });

      addSongForm.addEventListener("submit", (event) => {
        event.preventDefault();

        const newSongTitle = songInput.value.trim();
        const newSongYear = yearInput.value.trim();

        if (newSongTitle === "" || newSongYear === "") {
          return;
        }

        songs.push(`${newSongTitle} (${newSongYear})`);
        renderPlaylist();

        songInput.value = "";
        yearInput.value = "";
        songInput.focus();
      });

      renderPlaylist();
    });
  </script>
</BaseLayout>
